\href{https://circleci.com/gh/amasad/sane}{\tt }

\subsection*{sane }

I\textquotesingle{}ve been driven to insanity by node filesystem watcher wrappers. Sane aims to be fast, small, and reliable file system watcher. It does that by\+:


\begin{DoxyItemize}
\item By default stays away from fs polling because it\textquotesingle{}s very slow and cpu intensive
\item Uses {\ttfamily fs.\+watch} by default and sensibly works around the various issues
\item Maintains a consistent A\+PI across different platforms
\item Where {\ttfamily fs.\+watch} is not reliable you have the choice of using the following alternatives\+:
\begin{DoxyItemize}
\item \href{https://facebook.github.io/watchman/}{\tt the facebook watchman library}
\item polling
\end{DoxyItemize}
\end{DoxyItemize}

\subsection*{Install}


\begin{DoxyCode}
$ npm install sane
\end{DoxyCode}


\subsection*{How to choose a mode}

Don\textquotesingle{}t worry too much about choosing the correct mode upfront because sane maintains the same A\+PI across all modes and will be easy to switch.


\begin{DoxyItemize}
\item If you\textquotesingle{}re only supporting Linux and OS X, {\ttfamily watchman} would be the most reliable mode
\item If you\textquotesingle{}re using node $>$ v0.\+10.\+0 use the default mode
\item If you\textquotesingle{}re running OS X and you\textquotesingle{}re watching a lot of directories and you\textquotesingle{}re running into \href{https://github.com/joyent/node/issues/5463,}{\tt https\+://github.\+com/joyent/node/issues/5463,} use {\ttfamily watchman}
\item If you\textquotesingle{}re in an environment where native file system events aren\textquotesingle{}t available (like Vagrant), you should use polling
\item Otherwise, the default mode should work well for you
\end{DoxyItemize}

\subsection*{A\+PI}

\subsubsection*{sane(dir, options)}

Watches a directory and all it\textquotesingle{}s descendant directories for changes, deletions, and additions on files and directories.


\begin{DoxyCode}
var watcher = sane('path/to/dir', \{glob: ['**/*.js', '**/*.css']\});
watcher.on('ready', function () \{ console.log('ready') \});
watcher.on('change', function (filepath, root, stat) \{ console.log('file changed', filepath); \});
watcher.on('add', function (filepath, root, stat) \{ console.log('file added', filepath); \});
watcher.on('delete', function (filepath, root) \{ console.log('file deleted', filepath); \});
// close
watcher.close();
\end{DoxyCode}


options\+:


\begin{DoxyItemize}
\item {\ttfamily glob}\+: a single string glob pattern or an array of them.
\item {\ttfamily poll}\+: puts the watcher in polling mode. Under the hood that means {\ttfamily fs.\+watch\+File}.
\item {\ttfamily watchman}\+: makes the watcher use \href{https://facebook.github.io/watchman/}{\tt watchman}.
\item {\ttfamily dot}\+: enables watching files/directories that start with a dot.
\item {\ttfamily ignored}\+: a glob, regex, function, or array of any combination.
\end{DoxyItemize}

For the glob pattern documentation, see \href{https://github.com/isaacs/minimatch}{\tt minimatch}. If you choose to use {\ttfamily watchman} you\textquotesingle{}ll have to \href{https://facebook.github.io/watchman/docs/install.html}{\tt install watchman yourself}). For the ignored options, see \href{https://github.com/es128/anymatch}{\tt anymatch}.

\subsubsection*{sane.\+Node\+Watcher(dir, options)}

The default watcher class. Uses {\ttfamily fs.\+watch} under the hood, and takes the same options as {\ttfamily sane(options, dir)}.

\subsubsection*{sane.\+Watchman\+Watcher(dir, options)}

The watchman watcher class. Takes the same options as {\ttfamily sane(options, dir)}.

\subsubsection*{sane.\+Poll\+Watcher(dir, options)}

The polling watcher class. Takes the same options as {\ttfamily sane(options, dir)} with the addition of\+:


\begin{DoxyItemize}
\item interval\+: indicates how often the files should be polled. (passed to fs.\+watch\+File)
\end{DoxyItemize}

\subsubsection*{sane.\{Node$\vert$\+Watchman$\vert$\+Poll\}Watcher\+::close}

Stops watching.

\subsubsection*{sane.\{Node$\vert$\+Watchman$\vert$\+Poll\}Watcher events}

Emits the following events\+:

All events are passed the file/dir path relative to the root directory
\begin{DoxyItemize}
\item {\ttfamily ready} when the program is ready to detect events in the directory
\item {\ttfamily change} when a file changes
\item {\ttfamily add} when a file or directory has been added
\item {\ttfamily delete} when a file or directory has been deleted
\end{DoxyItemize}

\subsection*{C\+LI}

This module includes a simple command line interface, which you can install with {\ttfamily npm install sane -\/g}.


\begin{DoxyCode}
Usage: sane <command> [...directory] [--glob=<filePattern>] [--poll] [--watchman] [--dot]
       [--wait=<seconds>]

OPTIONS:
    --glob=<filePattern>
        A single string glob pattern or an array of them.

    --poll, -p
      Use polling mode.

    --watchman, -w
      Use watchman (if available).

    --dot, -d
      Enables watching files/directories that start with a dot.

    --wait=<seconds>
        Duration, in seconds, that watching will be disabled
        after running <command>. Setting this option will
        throttle calls to <command> for the specified duration.
\end{DoxyCode}


It will watch the given {\ttfamily directory} and run the given $<$command$>$ every time a file changes.

\subsubsection*{C\+LI example usage}


\begin{DoxyItemize}
\item `sane \textquotesingle{}echo \char`\"{}\+A command ran\char`\"{}'{\ttfamily  -\/}sane \textquotesingle{}echo \char`\"{}\+A command ran\char`\"{}\textquotesingle{} --glob=\textquotesingle{}$\ast$$\ast$/$\ast$.css\textquotesingle{}{\ttfamily  -\/}sane \textquotesingle{}echo \char`\"{}\+A command ran\char`\"{}\textquotesingle{} site/assets/css --glob=\textquotesingle{}$\ast$$\ast$/$\ast$.css\textquotesingle{}{\ttfamily  -\/}sane \textquotesingle{}echo \char`\"{}\+A command ran\char`\"{}\textquotesingle{} --wait=3{\ttfamily  -\/}sane \textquotesingle{}echo \char`\"{}\+A command ran\char`\"{}\textquotesingle{} -\/p\`{}
\end{DoxyItemize}

\subsection*{License}

M\+IT

\subsection*{Credits}

The C\+LI was originally based on the \href{https://github.com/mikeal/watch}{\tt watch C\+LI}. Watch is licensed under the Apache License Version 2.\+0. 