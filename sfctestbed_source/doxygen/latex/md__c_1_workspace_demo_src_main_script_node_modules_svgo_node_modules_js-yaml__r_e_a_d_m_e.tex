\href{https://travis-ci.org/nodeca/js-yaml}{\tt } \href{https://www.npmjs.org/package/js-yaml}{\tt }

{\bfseries \href{http://nodeca.github.com/js-yaml/}{\tt Online Demo}}

This is an implementation of \href{http://yaml.org/}{\tt Y\+A\+ML}, a human friendly data serialization language. Started as \href{http://pyyaml.org/}{\tt Py\+Y\+A\+ML} port, it was completely rewritten from scratch. Now it\textquotesingle{}s very fast, and supports 1.\+2 spec.

\subsection*{Installation }

\subsubsection*{Y\+A\+ML module for node.\+js}


\begin{DoxyCode}
npm install js-yaml
\end{DoxyCode}


\subsubsection*{C\+LI executable}

If you want to inspect your Y\+A\+ML files from C\+LI, install js-\/yaml globally\+:


\begin{DoxyCode}
npm install -g js-yaml
\end{DoxyCode}


\paragraph*{Usage}


\begin{DoxyCode}
usage: js-yaml [-h] [-v] [-c] [-t] file

Positional arguments:
  file           File with YAML document(s)

Optional arguments:
  -h, --help     Show this help message and exit.
  -v, --version  Show program's version number and exit.
  -c, --compact  Display errors in compact mode
  -t, --trace    Show stack trace on error
\end{DoxyCode}


\subsubsection*{Bundled Y\+A\+ML library for browsers}


\begin{DoxyCode}
<script src="esprima.js"></script>
<script src="js-yaml.min.js"></script>
<script type="text/javascript">
var doc = jsyaml.load('greeting: hello\(\backslash\)nname: world');
</script>
\end{DoxyCode}


Browser support was done mostly for online demo. If you find any errors -\/ feel free to send pull requests with fixes. Also note, that IE and other old browsers needs \href{https://github.com/kriskowal/es5-shim}{\tt es5-\/shims} to operate.

Notes\+:


\begin{DoxyEnumerate}
\item We have no resources to support browserified version. Don\textquotesingle{}t expect it to be well tested. Don\textquotesingle{}t expect fast fixes if something goes wrong there.
\item {\ttfamily !!js/function} in browser bundle will not work by default. If you really need it -\/ load {\ttfamily esprima} parser first (via amd or directly).
\item {\ttfamily !!bin} in browser will return {\ttfamily Array}, because browsers do not support node.\+js {\ttfamily Buffer} and adding Buffer shims is completely useless on practice.
\end{DoxyEnumerate}

\subsection*{A\+PI }

Here we cover the most \textquotesingle{}useful\textquotesingle{} methods. If you need advanced details (creating your own tags), see \href{https://github.com/nodeca/js-yaml/wiki}{\tt wiki} and \href{https://github.com/nodeca/js-yaml/tree/master/examples}{\tt examples} for more info.


\begin{DoxyCode}
yaml = require('js-yaml');
fs   = require('fs');

// Get document, or throw exception on error
try \{
  var doc = yaml.safeLoad(fs.readFileSync('/home/ixti/example.yml', 'utf8'));
  console.log(doc);
\} catch (e) \{
  console.log(e);
\}
\end{DoxyCode}


\subsubsection*{safe\+Load (string \mbox{[} , options \mbox{]})}

{\bfseries Recommended loading way.} Parses {\ttfamily string} as single Y\+A\+ML document. Returns a Java\+Script object or throws {\ttfamily Y\+A\+M\+L\+Exception} on error. By default, does not support regexps, functions and undefined. This method is safe for untrusted data.

options\+:


\begin{DoxyItemize}
\item {\ttfamily filename} \+\_\+(default\+: null)\+\_\+ -\/ string to be used as a file path in error/warning messages.
\item {\ttfamily on\+Warning} \+\_\+(default\+: null)\+\_\+ -\/ function to call on warning messages. Loader will throw on warnings if this function is not provided.
\item {\ttfamily schema} \+\_\+(default\+: {\ttfamily D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+A\+F\+E\+\_\+\+S\+C\+H\+E\+MA})\+\_\+ -\/ specifies a schema to use.
\begin{DoxyItemize}
\item {\ttfamily F\+A\+I\+L\+S\+A\+F\+E\+\_\+\+S\+C\+H\+E\+MA} -\/ only strings, arrays and plain objects\+: \href{http://www.yaml.org/spec/1.2/spec.html#id2802346}{\tt http\+://www.\+yaml.\+org/spec/1.\+2/spec.\+html\#id2802346}
\item {\ttfamily J\+S\+O\+N\+\_\+\+S\+C\+H\+E\+MA} -\/ all J\+S\+O\+N-\/supported types\+: \href{http://www.yaml.org/spec/1.2/spec.html#id2803231}{\tt http\+://www.\+yaml.\+org/spec/1.\+2/spec.\+html\#id2803231}
\item {\ttfamily C\+O\+R\+E\+\_\+\+S\+C\+H\+E\+MA} -\/ same as {\ttfamily J\+S\+O\+N\+\_\+\+S\+C\+H\+E\+MA}\+: \href{http://www.yaml.org/spec/1.2/spec.html#id2804923}{\tt http\+://www.\+yaml.\+org/spec/1.\+2/spec.\+html\#id2804923}
\item {\ttfamily D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+A\+F\+E\+\_\+\+S\+C\+H\+E\+MA} -\/ all supported Y\+A\+ML types, without unsafe ones ({\ttfamily !!js/undefined}, {\ttfamily !!js/regexp} and {\ttfamily !!js/function})\+: \href{http://yaml.org/type/}{\tt http\+://yaml.\+org/type/}
\item {\ttfamily D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+U\+L\+L\+\_\+\+S\+C\+H\+E\+MA} -\/ all supported Y\+A\+ML types.
\end{DoxyItemize}
\item {\ttfamily json} \+\_\+(default\+: false)\+\_\+ -\/ compatibility with J\+S\+O\+N.\+parse behaviour. If true, then duplicate keys in a mapping will override values rather than throwing an error.
\end{DoxyItemize}

N\+O\+TE\+: This function {\bfseries does not} understand multi-\/document sources, it throws exception on those.

N\+O\+TE\+: J\+S-\/\+Y\+A\+ML {\bfseries does not} support schema-\/specific tag resolution restrictions. So, J\+S\+ON schema is not as strict as defined in the Y\+A\+ML specification. It allows numbers in any notation, use {\ttfamily Null} and {\ttfamily N\+U\+LL} as {\ttfamily null}, etc. Core schema also has no such restrictions. It allows binary notation for integers.

\subsubsection*{load (string \mbox{[} , options \mbox{]})}

{\bfseries Use with care with untrusted sources}. The same as {\ttfamily safe\+Load()} but uses {\ttfamily D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+U\+L\+L\+\_\+\+S\+C\+H\+E\+MA} by default -\/ adds some Java\+Script-\/specific types\+: {\ttfamily !!js/function}, {\ttfamily !!js/regexp} and {\ttfamily !!js/undefined}. For untrusted sources you must additionally validate object structure, to avoid injections\+:


\begin{DoxyCode}
var untrusted\_code = '"toString": !<tag:yaml.org,2002:js/function> "function ()\{very\_evil\_thing();\}"';

// I'm just converting that string, what could possibly go wrong?
require('js-yaml').load(untrusted\_code) + ''
\end{DoxyCode}


\subsubsection*{safe\+Load\+All (string, iterator \mbox{[} , options \mbox{]})}

Same as {\ttfamily safe\+Load()}, but understands multi-\/document sources and apply {\ttfamily iterator} to each document.


\begin{DoxyCode}
var yaml = require('js-yaml');

yaml.safeLoadAll(data, function (doc) \{
  console.log(doc);
\});
\end{DoxyCode}


\subsubsection*{load\+All (string, iterator \mbox{[} , options \mbox{]})}

Same as {\ttfamily safe\+Load\+All()} but uses {\ttfamily D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+U\+L\+L\+\_\+\+S\+C\+H\+E\+MA} by default.

\subsubsection*{safe\+Dump (object \mbox{[} , options \mbox{]})}

Serializes {\ttfamily object} as Y\+A\+ML document. Uses {\ttfamily D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+A\+F\+E\+\_\+\+S\+C\+H\+E\+MA}, so it will throw exception if you try to dump regexps or functions. However, you can disable exceptions by {\ttfamily skip\+Invalid} option.

options\+:


\begin{DoxyItemize}
\item {\ttfamily indent} \+\_\+(default\+: 2)\+\_\+ -\/ indentation width to use (in spaces).
\item {\ttfamily skip\+Invalid} \+\_\+(default\+: false)\+\_\+ -\/ do not throw on invalid types (like function in the safe schema) and skip pairs and single values with such types.
\item {\ttfamily flow\+Level} (default\+: -\/1) -\/ specifies level of nesting, when to switch from block to flow style for collections. -\/1 means block style everwhere
\item {\ttfamily styles} -\/ \char`\"{}tag\char`\"{} =$>$ \char`\"{}style\char`\"{} map. Each tag may have own set of styles.
\item {\ttfamily schema} \+\_\+(default\+: {\ttfamily D\+E\+F\+A\+U\+L\+T\+\_\+\+S\+A\+F\+E\+\_\+\+S\+C\+H\+E\+MA})\+\_\+ specifies a schema to use.
\item {\ttfamily sort\+Keys} \+\_\+(default\+: {\ttfamily false})\+\_\+ -\/ if {\ttfamily true}, sort keys when dumping Y\+A\+ML. If a function, use the function to sort the keys.
\item {\ttfamily line\+Width} \+\_\+(default\+: {\ttfamily 80})\+\_\+ -\/ set max line width.
\item {\ttfamily no\+Refs} \+\_\+(default\+: {\ttfamily false})\+\_\+ -\/ if {\ttfamily true}, don\textquotesingle{}t convert duplicate objects into references
\item {\ttfamily no\+Compat\+Mode} \+\_\+(default\+: {\ttfamily false})\+\_\+ -\/ if {\ttfamily true} don\textquotesingle{}t try to be compatible with older yaml versions. Currently\+: don\textquotesingle{}t quote \char`\"{}yes\char`\"{}, \char`\"{}no\char`\"{} and so on, as required for Y\+A\+ML 1.\+1
\end{DoxyItemize}

styles\+:


\begin{DoxyCode}
!!null
  "canonical"   => "~"

!!int
  "binary"      => "0b1", "0b101010", "0b1110001111010"
  "octal"       => "01", "052", "016172"
  "decimal"     => "1", "42", "7290"
  "hexadecimal" => "0x1", "0x2A", "0x1C7A"

!!null, !!bool, !!float
  "lowercase"   => "null", "true", "false", ".nan", '.inf'
  "uppercase"   => "NULL", "TRUE", "FALSE", ".NAN", '.INF'
  "camelcase"   => "Null", "True", "False", ".NaN", '.Inf'
\end{DoxyCode}


By default, !!int uses {\ttfamily decimal}, and !!null, !!bool, !!float use {\ttfamily lowercase}.

\subsubsection*{dump (object \mbox{[} , options \mbox{]})}

Same as {\ttfamily safe\+Dump()} but without limits (uses {\ttfamily D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+U\+L\+L\+\_\+\+S\+C\+H\+E\+MA} by default).

\subsection*{Supported Y\+A\+ML types }

The list of standard Y\+A\+ML tags and corresponding Java\+Scipt types. See also \href{http://pyyaml.org/wiki/YAMLTagDiscussion}{\tt Y\+A\+ML tag discussion} and \href{http://yaml.org/type/}{\tt Y\+A\+ML types repository}.


\begin{DoxyCode}
!!null ''                   # null
!!bool 'yes'                # bool
!!int '3...'                # number
!!float '3.14...'           # number
!!binary '...base64...'     # buffer
!!timestamp 'YYYY-...'      # date
!!omap [ ... ]              # array of key-value pairs
!!pairs [ ... ]             # array or array pairs
!!set \{ ... \}               # array of objects with given keys and null values
!!str '...'                 # string
!!seq [ ... ]               # array
!!map \{ ... \}               # object
\end{DoxyCode}


{\bfseries Java\+Script-\/specific tags}


\begin{DoxyCode}
!!js/regexp /pattern/gim            # RegExp
!!js/undefined ''                   # Undefined
!!js/function 'function () \{...\}'   # Function
\end{DoxyCode}


\subsection*{Caveats }

Note, that you use arrays or objects as key in J\+S-\/\+Y\+A\+ML. JS does not allow objects or array as keys, and stringifies (by calling .to\+String method) them at the moment of adding them.


\begin{DoxyCode}
---
? [ foo, bar ]
: - baz
? \{ foo: bar \}
: - baz
  - baz
\end{DoxyCode}



\begin{DoxyCode}
\{ "foo,bar": ["baz"], "[object Object]": ["baz", "baz"] \}
\end{DoxyCode}


Also, reading of properties on implicit block mapping keys is not supported yet. So, the following Y\+A\+ML document cannot be loaded.


\begin{DoxyCode}
&anchor foo:
  foo: bar
  *anchor: duplicate key
  baz: bat
  *anchor: duplicate key
\end{DoxyCode}


\subsection*{Breaking changes in 2.\+x.\+x -\/$>$ 3.\+x.\+x }

If you have not used {\bfseries custom} tags or loader classes and not loaded yaml files via {\ttfamily require()} -\/ no changes needed. Just upgrade library.

Otherwise, you should\+:


\begin{DoxyEnumerate}
\item Replace all occurences of `require(\textquotesingle{}xxxx.\+yml'){\ttfamily by}fs.\+read\+File\+Sync(){\ttfamily + }yaml.\+safe\+Load()\`{}.
\item rewrite your custom tags constructors and custom loader classes, to conform new A\+PI. See \href{https://github.com/nodeca/js-yaml/tree/master/examples}{\tt examples} and \href{https://github.com/nodeca/js-yaml/wiki}{\tt wiki} for details.
\end{DoxyEnumerate}

\subsection*{License }

View the \href{https://github.com/nodeca/js-yaml/blob/master/LICENSE}{\tt L\+I\+C\+E\+N\+SE} file (M\+IT). 