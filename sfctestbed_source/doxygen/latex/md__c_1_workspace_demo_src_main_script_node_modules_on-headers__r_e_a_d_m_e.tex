\href{https://npmjs.org/package/on-headers}{\tt } \href{https://npmjs.org/package/on-headers}{\tt } \href{http://nodejs.org/download/}{\tt } \href{https://travis-ci.org/jshttp/on-headers}{\tt } \href{https://coveralls.io/r/jshttp/on-headers?branch=master}{\tt }

Execute a listener when a response is about to write headers.

\subsection*{Installation}


\begin{DoxyCode}
$ npm install on-headers
\end{DoxyCode}


\subsection*{A\+PI}


\begin{DoxyCode}
var onHeaders = require('on-headers')
\end{DoxyCode}


\subsubsection*{on\+Headers(res, listener)}

This will add the listener {\ttfamily listener} to fire when headers are emitted for {\ttfamily res}. The listener is passed the {\ttfamily response} object as it\textquotesingle{}s context ({\ttfamily this}). Headers are considered to be emitted only once, right before they are sent to the client.

When this is called multiple times on the same {\ttfamily res}, the {\ttfamily listener}s are fired in the reverse order they were added.

\subsection*{Examples}


\begin{DoxyCode}
var http = require('http')
var onHeaders = require('on-headers')

http
.createServer(onRequest)
.listen(3000)

function addPoweredBy() \{
  // set if not set by end of request
  if (!this.getHeader('X-Powered-By')) \{
    this.setHeader('X-Powered-By', 'Node.js')
  \}
\}

function onRequest(req, res) \{
  onHeaders(res, addPoweredBy)

  res.setHeader('Content-Type', 'text/plain')
  res.end('hello!')
\}
\end{DoxyCode}


\subsection*{Testing}


\begin{DoxyCode}
$ npm test
\end{DoxyCode}


\subsection*{License}

\mbox{[}M\+IT\mbox{]}(L\+I\+C\+E\+N\+SE) 