This package implements the H\+T\+ML Standard\textquotesingle{}s \href{https://html.spec.whatwg.org/multipage/syntax.html#encoding-sniffing-algorithm}{\tt encoding sniffing algorithm} in all its glory. The most interesting part of this is how it pre-\/scans the first 1024 bytes in order to search for certain {\ttfamily $<$meta charset$>$}-\/related patterns.


\begin{DoxyCode}
const htmlEncodingSniffer = require("html-encoding-sniffer");
const fs = require("fs");

const htmlBuffer = fs.readFileSync("./html-page.html");
const sniffedEncoding = htmlEncodingSniffer(htmlBuffer);
\end{DoxyCode}


The returned value will be a canonical \href{https://encoding.spec.whatwg.org/#names-and-labels}{\tt encoding name} (not a label). You might then combine this with the \href{https://github.com/jsdom/whatwg-encoding}{\tt whatwg-\/encoding} package to decode the result\+:


\begin{DoxyCode}
const whatwgEncoding = require("whatwg-encoding");
const htmlString = whatwgEncoding.decode(htmlBuffer, sniffedEncoding);
\end{DoxyCode}


\subsection*{Options}

You can pass two potential options to {\ttfamily html\+Encoding\+Sniffer}\+:


\begin{DoxyCode}
const sniffedEncoding = htmlEncodingSniffer(htmlBuffer, \{
  transportLayerEncodingLabel,
  defaultEncoding
\});
\end{DoxyCode}


These represent two possible inputs into the \href{https://html.spec.whatwg.org/multipage/syntax.html#encoding-sniffing-algorithm}{\tt encoding sniffing algorithm}\+:


\begin{DoxyItemize}
\item {\ttfamily transport\+Layer\+Encoding\+Label} is an encoding label that is obtained from the \char`\"{}transport layer\char`\"{} (probably a H\+T\+TP {\ttfamily Content-\/\+Type} header), which overrides everything but a B\+OM.
\item {\ttfamily default\+Encoding} is the ultimate fallback encoding used if no valid encoding is supplied by the transport layer, and no encoding is sniffed from the bytes. It defaults to {\ttfamily \char`\"{}windows-\/1252\char`\"{}}, as recommended by the algorithm\textquotesingle{}s table of suggested defaults for \char`\"{}\+All other locales\char`\"{} (including the {\ttfamily en} locale).
\end{DoxyItemize}

\subsection*{Credits}

This package was originally based on the excellent work of \href{https://github.com/nicolashenry}{\tt }, \href{https://github.com/tmpvar/jsdom/blob/16fd85618f2705d181232f6552125872a37164bc/lib/jsdom/living/helpers/encoding.js}{\tt in jsdom}. It has since been pulled out into this separate package. 