\href{https://nodei.co/npm/eventsource/}{\tt } \href{https://nodei.co/npm/eventsource/}{\tt }

This library implements the \href{http://dev.w3.org/html5/eventsource/}{\tt Event\+Source} client for Node.\+js. The A\+PI aims to be W3C compatible.

\subsection*{Install}

\begin{DoxyVerb}npm install eventsource
\end{DoxyVerb}


\subsection*{Usage}


\begin{DoxyCode}
var EventSource = require('eventsource');

var es = new EventSource('http://demo-eventsource.rhcloud.com/');
es.onmessage = function(e) \{
  console.log(e.data);
\};
es.onerror = function() \{
  console.log('ERROR!');
\};
\end{DoxyCode}


See the \href{http://dev.w3.org/html5/eventsource/}{\tt spec} for A\+PI docs.

\subsection*{Example}

See \href{https://github.com/einaros/sse-example}{\tt https\+://github.\+com/einaros/sse-\/example}

\subsection*{Extensions to the W3C A\+PI}

\subsubsection*{Setting H\+T\+TP request headers}

You can define custom H\+T\+TP headers for the initial H\+T\+TP request. This can be useful for e.\+g. sending cookies or to specify an initial {\ttfamily Last-\/\+Event-\/\+ID} value.

H\+T\+TP headers are defined by assigning a {\ttfamily headers} attribute to the optional {\ttfamily event\+Source\+Init\+Dict} argument\+:


\begin{DoxyCode}
var eventSourceInitDict = \{headers: \{'Cookie': 'test=test'\}\};
var es = new EventSource(url, eventSourceInitDict);
\end{DoxyCode}


\subsubsection*{Allow unauthorized H\+T\+T\+PS requests}

By default, https requests that cannot be authorized will cause connection to fail and an exception to be emitted. You can override this behaviour\+:


\begin{DoxyCode}
var eventSourceInitDict = \{rejectUnauthorized: false\};
var es = new EventSource(url, eventSourceInitDict);
\end{DoxyCode}


Note that for Node.\+js $<$ v0.\+10.\+x this option has no effect -\/ unauthorized H\+T\+T\+PS requests are {\itshape always} allowed.

\subsubsection*{H\+T\+TP status code on error events}

Unauthorized and redirect error status codes (for example 401, 403, 301, 307) are available in the {\ttfamily status} property in the error event.


\begin{DoxyCode}
es.onerror = function (err) \{
  if (err) \{
    if (err.status === 401 || err.status === 403) \{
      console.log('not authorized');
    \}
  \}
\};
\end{DoxyCode}
 