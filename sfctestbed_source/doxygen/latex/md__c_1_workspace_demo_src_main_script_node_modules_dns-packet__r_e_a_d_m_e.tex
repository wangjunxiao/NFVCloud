An \href{https://github.com/mafintosh/abstract-encoding}{\tt abstract-\/encoding} compliant module for encoding / decoding D\+NS packets. Lifted out of \href{https://github.com/mafintosh/multicast-dns}{\tt multicast-\/dns} as a separate module.


\begin{DoxyCode}
npm install dns-packet
\end{DoxyCode}


\href{https://travis-ci.org/mafintosh/dns-packet}{\tt }

\subsection*{Usage}


\begin{DoxyCode}
var packet = require('dns-packet')
var dgram = require('dgram')

var socket = dgram.createSocket('udp4')

var buf = packet.encode(\{
  type: 'query',
  id: 1,
  flags: packet.RECURSION\_DESIRED,
  questions: [\{
    type: 'A',
    name: 'google.com'
  \}]
\})

socket.on('message', function (message) \{
  console.log(packet.decode(message)) // prints out a response from google dns
\})

socket.send(buf, 0, buf.length, 53, '8.8.8.8')
\end{DoxyCode}


\subsection*{A\+PI}

\paragraph*{{\ttfamily var buf = packets.\+encode(packet, \mbox{[}buf\mbox{]}, \mbox{[}offset\mbox{]})}}

Encodes a D\+NS packet into a buffer.

\paragraph*{{\ttfamily var packet = packets.\+decode(buf, \mbox{[}offset\mbox{]})}}

Decode a D\+NS packet from a buffer

\paragraph*{{\ttfamily var len = packets.\+encoding\+Length(packet)}}

Returns how many bytes are needed to encode the D\+NS packet

\subsection*{Packets}

Packets look like this


\begin{DoxyCode}
\{
  type: 'query|response',
  id: optionalIdNumber,
  flags: optionalBitFlags,
  questions: [...],
  answers: [...],
  additionals: [...],
  authorities: [...]
\}
\end{DoxyCode}


The bit flags available are


\begin{DoxyCode}
packet.RECURSION\_DESIRED
packet.RECURSION\_AVAILABLE
packet.TRUNCATED\_RESPONSE
packet.AUTHORITATIVE\_ANSWER
packet.AUTHENTIC\_DATA
packet.CHECKING\_DISABLED
\end{DoxyCode}


To use more than one flag bitwise-\/or them together


\begin{DoxyCode}
var flags = packet.RECURSION\_DESIRED | packet.RECURSION\_AVAILABLE
\end{DoxyCode}


And to check for a flag use bitwise-\/and


\begin{DoxyCode}
var isRecursive = message.flags & packet.RECURSION\_DESIRED
\end{DoxyCode}


A question looks like this


\begin{DoxyCode}
\{
  type: 'A', // or SRV, AAAA, etc
  name: 'google.com' // which record are you looking for
\}
\end{DoxyCode}


And an answers, additional, or authority looks like this


\begin{DoxyCode}
\{
  type: 'A', // or SRV, AAAA, etc
  name: 'google.com', // which name is this record for
  ttl: optionalTimeToLiveInSeconds,
  (record specific data, see below)
\}
\end{DoxyCode}


Currently the different available records are

\paragraph*{{\ttfamily A}}


\begin{DoxyCode}
\{
  data: 'IPv4 address' // fx 127.0.0.1
\}
\end{DoxyCode}


\paragraph*{{\ttfamily A\+A\+AA}}


\begin{DoxyCode}
\{
  data: 'IPv6 address' // fx fe80::1
\}
\end{DoxyCode}


\paragraph*{{\ttfamily T\+XT}}


\begin{DoxyCode}
\{
  data: Buffer('some text')
\}
\end{DoxyCode}


\paragraph*{{\ttfamily N\+U\+LL}}


\begin{DoxyCode}
\{
  data: Buffer('any binary data')
\}
\end{DoxyCode}


\paragraph*{{\ttfamily S\+RV}}


\begin{DoxyCode}
\{
  data: \{
    port: servicePort,
    target: serviceHostName,
    priority: optionalServicePriority,
    weight: optionalServiceWeight
  \}
\}
\end{DoxyCode}


\paragraph*{{\ttfamily H\+I\+N\+FO}}


\begin{DoxyCode}
\{
  data: \{
    cpu: 'cpu info',
    os: 'os info'
  \}
\}
\end{DoxyCode}


\paragraph*{{\ttfamily P\+TR}}


\begin{DoxyCode}
\{
  data: 'points.to.another.record'
\}
\end{DoxyCode}


\paragraph*{{\ttfamily C\+N\+A\+ME}}


\begin{DoxyCode}
\{
  data: 'cname.to.another.record'
\}
\end{DoxyCode}


\paragraph*{{\ttfamily D\+N\+A\+ME}}


\begin{DoxyCode}
\{
  data: 'dname.to.another.record'
\}
\end{DoxyCode}


If you need another one, open an issue and we\textquotesingle{}ll try to add it.

\subsection*{License}

M\+IT 