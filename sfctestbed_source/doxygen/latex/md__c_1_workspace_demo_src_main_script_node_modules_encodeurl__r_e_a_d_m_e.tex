\href{https://npmjs.org/package/encodeurl}{\tt } \href{https://npmjs.org/package/encodeurl}{\tt } \href{https://nodejs.org/en/download}{\tt } \href{https://travis-ci.org/pillarjs/encodeurl}{\tt } \href{https://coveralls.io/r/pillarjs/encodeurl?branch=master}{\tt }

Encode a \mbox{\hyperlink{namespace_u_r_l}{U\+RL}} to a percent-\/encoded form, excluding already-\/encoded sequences

\subsection*{Installation}


\begin{DoxyCode}
$ npm install encodeurl
\end{DoxyCode}


\subsection*{A\+PI}


\begin{DoxyCode}
var encodeUrl = require('encodeurl')
\end{DoxyCode}


\subsubsection*{encode\+Url(url)}

Encode a \mbox{\hyperlink{namespace_u_r_l}{U\+RL}} to a percent-\/encoded form, excluding already-\/encoded sequences.

This function will take an already-\/encoded \mbox{\hyperlink{namespace_u_r_l}{U\+RL}} and encode all the non-\/\+U\+RL code points (as U\+T\+F-\/8 byte sequences). This function will not encode the \char`\"{}\%\char`\"{} character unless it is not part of a valid sequence ({\ttfamily \%20} will be left as-\/is, but {\ttfamily foo} will be encoded as {\ttfamily \%25foo}).

This encode is meant to be \char`\"{}safe\char`\"{} and does not throw errors. It will try as hard as it can to properly encode the given \mbox{\hyperlink{namespace_u_r_l}{U\+RL}}, including replacing any raw, unpaired surrogate pairs with the Unicode replacement character prior to encoding.

This function is {\itshape similar} to the intrinsic function {\ttfamily encode\+U\+RI}, except it will not encode the {\ttfamily \%} character if that is part of a valid sequence, will not encode {\ttfamily \mbox{[}} and {\ttfamily \mbox{]}} (for I\+Pv6 hostnames) and will replace raw, unpaired surrogate pairs with the Unicode replacement character (instead of throwing).

\subsection*{Examples}

\subsubsection*{Encode a \mbox{\hyperlink{namespace_u_r_l}{U\+RL}} containing user-\/controled data}


\begin{DoxyCode}
var encodeUrl = require('encodeurl')
var escapeHtml = require('escape-html')

http.createServer(function onRequest (req, res) \{
  // get encoded form of inbound url
  var url = encodeUrl(req.url)

  // create html message
  var body = '<p>Location ' + escapeHtml(url) + ' not found</p>'

  // send a 404
  res.statusCode = 404
  res.setHeader('Content-Type', 'text/html; charset=UTF-8')
  res.setHeader('Content-Length', String(Buffer.byteLength(body, 'utf-8')))
  res.end(body, 'utf-8')
\})
\end{DoxyCode}


\subsubsection*{Encode a \mbox{\hyperlink{namespace_u_r_l}{U\+RL}} for use in a header field}


\begin{DoxyCode}
var encodeUrl = require('encodeurl')
var escapeHtml = require('escape-html')
var url = require('url')

http.createServer(function onRequest (req, res) \{
  // parse inbound url
  var href = url.parse(req)

  // set new host for redirect
  href.host = 'localhost'
  href.protocol = 'https:'
  href.slashes = true

  // create location header
  var location = encodeUrl(url.format(href))

  // create html message
  var body = '<p>Redirecting to new site: ' + escapeHtml(location) + '</p>'

  // send a 301
  res.statusCode = 301
  res.setHeader('Content-Type', 'text/html; charset=UTF-8')
  res.setHeader('Content-Length', String(Buffer.byteLength(body, 'utf-8')))
  res.setHeader('Location', location)
  res.end(body, 'utf-8')
\})
\end{DoxyCode}


\subsection*{Testing}


\begin{DoxyCode}
$ npm test
$ npm run lint
\end{DoxyCode}


\subsection*{References}


\begin{DoxyItemize}
\item \href{https://tools.ietf.org/html/rfc3986}{\tt R\+FC 3986\+: Uniform Resource Identifier (U\+RI)\+: Generic Syntax}
\item \href{https://url.spec.whatwg.org/}{\tt W\+H\+A\+T\+WG U\+RL Living Standard}
\end{DoxyItemize}

\subsection*{License}

\mbox{[}M\+IT\mbox{]}(L\+I\+C\+E\+N\+SE) 