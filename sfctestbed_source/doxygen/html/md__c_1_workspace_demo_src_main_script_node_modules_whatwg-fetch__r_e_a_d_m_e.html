<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>demo: window.fetch polyfill</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">demo
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Vfunc Spring Boot项目概要</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">window.fetch polyfill </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <code>fetch()</code> function is a Promise-based mechanism for programmatically making web requests in the browser. This project is a polyfill that implements a subset of the standard <a href="https://fetch.spec.whatwg.org">Fetch specification</a>, enough to make <code>fetch</code> a viable replacement for most uses of XMLHttpRequest in traditional web applications.</p>
<p>This project adheres to the <a href="http://todogroup.org/opencodeofconduct/#fetch/opensource@github.com">Open Code of Conduct</a>. By participating, you are expected to uphold this code.</p>
<h2>Table of Contents</h2>
<ul>
<li><a href="#read-this-first">Read this first</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#usage">Usage</a><ul>
<li><a href="#html">HTML</a></li>
<li><a href="#json">JSON</a></li>
<li><a href="#response-metadata">Response metadata</a></li>
<li><a href="#post-form">Post form</a></li>
<li><a href="#post-json">Post JSON</a></li>
<li><a href="#file-upload">File upload</a></li>
<li><a href="#caveats">Caveats</a><ul>
<li><a href="#handling-http-error-statuses">Handling HTTP error statuses</a></li>
<li><a href="#sending-cookies">Sending cookies</a></li>
<li><a href="#receiving-cookies">Receiving cookies</a></li>
<li><a href="#obtaining-the-response-url">Obtaining the Response URL</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#browser-support">Browser Support</a></li>
</ul>
<h2>Read this first</h2>
<ul>
<li>If you believe you found a bug with how <code>fetch</code> behaves in Chrome or Firefox, please <b>avoid opening an issue in this repository</b>. This project is a <em>polyfill</em>, and since Chrome and Firefox both implement the <code>window.fetch</code> function natively, no code from this project actually takes any effect in these browsers. See <a href="#browser-support">Browser support</a> for detailed information.</li>
<li>If you have trouble <b>making a request to another domain</b> (a different subdomain or port number also constitutes as another domain), please familiarize yourself with all the intricacies and limitations of <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS" title="Cross-origin resource sharing">CORS</a> requests. Because CORS requires participation of the server by implementing specific HTTP response headers, it is often nontrivial to set up or debug. CORS is exclusively handled by the browser's internal mechanisms which this polyfill cannot influence.</li>
<li>If you have trouble <b>maintaining the user's session</b> or <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet" title="Cross-site request forgery">CSRF</a> protection through <code>fetch</code> requests, please ensure that you've read and understood the <a href="#sending-cookies">Sending cookies</a> section.</li>
<li>If this polyfill <b>doesn't work under Node.js environments</b>, that is expected, because this project is meant for web browsers only. You should ensure that your application doesn't try to package and run this on the server.</li>
<li>If you have an idea for a new feature of <code>fetch</code>, please understand that we are only ever going to add features and APIs that are a part of the <a href="https://fetch.spec.whatwg.org">Fetch specification</a>. You should <b>submit your feature requests</b> to the <a href="https://github.com/whatwg/fetch/issues">repository of the specification</a> itself, rather than this repository.</li>
</ul>
<h2>Installation</h2>
<ul>
<li><code>npm install whatwg-fetch --save</code>; or</li>
<li><code>bower install fetch</code>.</li>
</ul>
<p>You will also need a Promise polyfill for <a href="http://caniuse.com/#feat=promises">older browsers</a>. We recommend <a href="https://github.com/taylorhakes/promise-polyfill">taylorhakes/promise-polyfill</a> for its small size and Promises/A+ compatibility.</p>
<p>For use with webpack, add this package in the <code>entry</code> configuration option before your application entry point:</p>
<div class="fragment"><div class="line">entry: [&#39;whatwg-fetch&#39;, ...]</div></div><!-- fragment --><p>For Babel and ES2015+, make sure to import the file:</p>
<div class="fragment"><div class="line">import &#39;whatwg-fetch&#39;</div></div><!-- fragment --><h2>Usage</h2>
<p>For a more comprehensive API reference that this polyfill supports, refer to <a href="https://github.github.io/fetch/">https://github.github.io/fetch/</a>.</p>
<h3>HTML</h3>
<div class="fragment"><div class="line">fetch(&#39;/users.html&#39;)</div><div class="line">  .then(function(response) {</div><div class="line">    return response.text()</div><div class="line">  }).then(function(body) {</div><div class="line">    document.body.innerHTML = body</div><div class="line">  })</div></div><!-- fragment --><h3>JSON</h3>
<div class="fragment"><div class="line">fetch(&#39;/users.json&#39;)</div><div class="line">  .then(function(response) {</div><div class="line">    return response.json()</div><div class="line">  }).then(function(json) {</div><div class="line">    console.log(&#39;parsed json&#39;, json)</div><div class="line">  }).catch(function(ex) {</div><div class="line">    console.log(&#39;parsing failed&#39;, ex)</div><div class="line">  })</div></div><!-- fragment --><h3>Response metadata</h3>
<div class="fragment"><div class="line">fetch(&#39;/users.json&#39;).then(function(response) {</div><div class="line">  console.log(response.headers.get(&#39;Content-Type&#39;))</div><div class="line">  console.log(response.headers.get(&#39;Date&#39;))</div><div class="line">  console.log(response.status)</div><div class="line">  console.log(response.statusText)</div><div class="line">})</div></div><!-- fragment --><h3>Post form</h3>
<div class="fragment"><div class="line">var form = document.querySelector(&#39;form&#39;)</div><div class="line"></div><div class="line">fetch(&#39;/users&#39;, {</div><div class="line">  method: &#39;POST&#39;,</div><div class="line">  body: new FormData(form)</div><div class="line">})</div></div><!-- fragment --><h3>Post JSON</h3>
<div class="fragment"><div class="line">fetch(&#39;/users&#39;, {</div><div class="line">  method: &#39;POST&#39;,</div><div class="line">  headers: {</div><div class="line">    &#39;Content-Type&#39;: &#39;application/json&#39;</div><div class="line">  },</div><div class="line">  body: JSON.stringify({</div><div class="line">    name: &#39;Hubot&#39;,</div><div class="line">    login: &#39;hubot&#39;,</div><div class="line">  })</div><div class="line">})</div></div><!-- fragment --><h3>File upload</h3>
<div class="fragment"><div class="line">var input = document.querySelector(&#39;input[type=&quot;file&quot;]&#39;)</div><div class="line"></div><div class="line">var data = new FormData()</div><div class="line">data.append(&#39;file&#39;, input.files[0])</div><div class="line">data.append(&#39;user&#39;, &#39;hubot&#39;)</div><div class="line"></div><div class="line">fetch(&#39;/avatars&#39;, {</div><div class="line">  method: &#39;POST&#39;,</div><div class="line">  body: data</div><div class="line">})</div></div><!-- fragment --><h3>Caveats</h3>
<p>The <code>fetch</code> specification differs from <code>jQuery.ajax()</code> in mainly two ways that bear keeping in mind:</p>
<ul>
<li>The Promise returned from <code>fetch()</code> <b>won't reject on HTTP error status</b> even if the response is an HTTP 404 or 500. Instead, it will resolve normally, and it will only reject on network failure or if anything prevented the request from completing.</li>
<li>By default, <code>fetch</code> <b>won't send or receive any cookies</b> from the server, resulting in unauthenticated requests if the site relies on maintaining a user session. See <a href="#sending-cookies">Sending cookies</a> for how to opt into cookie handling.</li>
</ul>
<h4>Handling HTTP error statuses</h4>
<p>To have <code>fetch</code> Promise reject on HTTP error statuses, i.e. on any non-2xx status, define a custom response handler:</p>
<div class="fragment"><div class="line">function checkStatus(response) {</div><div class="line">  if (response.status &gt;= 200 &amp;&amp; response.status &lt; 300) {</div><div class="line">    return response</div><div class="line">  } else {</div><div class="line">    var error = new Error(response.statusText)</div><div class="line">    error.response = response</div><div class="line">    throw error</div><div class="line">  }</div><div class="line">}</div><div class="line"></div><div class="line">function parseJSON(response) {</div><div class="line">  return response.json()</div><div class="line">}</div><div class="line"></div><div class="line">fetch(&#39;/users&#39;)</div><div class="line">  .then(checkStatus)</div><div class="line">  .then(parseJSON)</div><div class="line">  .then(function(data) {</div><div class="line">    console.log(&#39;request succeeded with JSON response&#39;, data)</div><div class="line">  }).catch(function(error) {</div><div class="line">    console.log(&#39;request failed&#39;, error)</div><div class="line">  })</div></div><!-- fragment --><h4>Sending cookies</h4>
<p>To automatically send cookies for the current domain, the <code>credentials</code> option must be provided:</p>
<div class="fragment"><div class="line">fetch(&#39;/users&#39;, {</div><div class="line">  credentials: &#39;same-origin&#39;</div><div class="line">})</div></div><!-- fragment --><p>The "same-origin" value makes <code>fetch</code> behave similarly to XMLHttpRequest with regards to cookies. Otherwise, cookies won't get sent, resulting in these requests not preserving the authentication session.</p>
<p>For <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS" title="Cross-origin resource sharing">CORS</a> requests, use the "include" value to allow sending credentials to other domains:</p>
<div class="fragment"><div class="line">fetch(&#39;https://example.com:1234/users&#39;, {</div><div class="line">  credentials: &#39;include&#39;</div><div class="line">})</div></div><!-- fragment --><h4>Receiving cookies</h4>
<p>As with XMLHttpRequest, the <code>Set-Cookie</code> response header returned from the server is a <a href="https://developer.mozilla.org/en-US/docs/Glossary/Forbidden_header_name">forbidden header name</a> and therefore can't be programmatically read with <code>response.headers.get()</code>. Instead, it's the browser's responsibility to handle new cookies being set (if applicable to the current <a class="el" href="namespace_u_r_l.html">URL</a>). Unless they are HTTP-only, new cookies will be available through <code>document.cookie</code>.</p>
<p>Bear in mind that the default behavior of <code>fetch</code> is to ignore the <code>Set-Cookie</code> header completely. To opt into accepting cookies from the server, you must use the <code>credentials</code> option.</p>
<h4>Obtaining the Response <a class="el" href="namespace_u_r_l.html">URL</a></h4>
<p>Due to limitations of XMLHttpRequest, the <code>response.url</code> value might not be reliable after HTTP redirects on older browsers.</p>
<p>The solution is to configure the server to set the response HTTP header <code>X-Request-URL</code> to the current <a class="el" href="namespace_u_r_l.html">URL</a> after any redirect that might have happened. It should be safe to set it unconditionally.</p>
<div class="fragment"><div class="line"># Ruby on Rails controller example</div><div class="line">response.headers[&#39;X-Request-URL&#39;] = request.url</div></div><!-- fragment --><p>This server workaround is necessary if you need reliable <code>response.url</code> in Firefox &lt; 32, Chrome &lt; 37, Safari, or IE.</p>
<h2>Browser Support</h2>
<ul>
<li>Chrome</li>
<li>Firefox</li>
<li>Safari 6.1+</li>
<li>Internet Explorer 10+</li>
</ul>
<p>Note: modern browsers such as Chrome, Firefox, and Microsoft Edge contain native implementations of <code>window.fetch</code>, therefore the code from this polyfill doesn't have any effect on those browsers. If you believe you've encountered an error with how <code>window.fetch</code> is implemented in any of these browsers, you should file an issue with that browser vendor instead of this project. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者 &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
