<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>demo: ajv-keywords</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">demo
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Vfunc Spring Boot项目概要</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ajv-keywords </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Custom JSON-Schema keywords for <a href="https://github.com/epoberezkin/ajv">ajv</a> validator</p>
<p><a href="https://travis-ci.org/epoberezkin/ajv-keywords"></a> <a href="https://www.npmjs.com/package/ajv-keywords"></a> <a href="https://www.npmjs.com/package/ajv-keywords"></a> <a href="https://coveralls.io/github/epoberezkin/ajv-keywords?branch=master"></a></p>
<h2>Contents</h2>
<ul>
<li><a href="#install">Install</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#keywords">Keywords</a><ul>
<li><a href="#typeof">typeof</a></li>
<li><a href="#instanceof">instanceof</a></li>
<li><a href="#range-and-exclusiverange">range and exclusiveRange</a></li>
<li><a href="#propertynames">propertyNames</a></li>
<li><a href="#ifthenelse">if/then/else</a></li>
<li><a href="#prohibited">prohibited</a></li>
<li><a href="#deepproperties">deepProperties</a></li>
<li><a href="#deeprequired">deepRequired</a></li>
<li><a href="#regexp">regexp</a></li>
<li><a href="#dynamicdefaults">dynamicDefaults</a></li>
</ul>
</li>
<li><a href="#license">License</a></li>
</ul>
<h2>Install</h2>
<div class="fragment"><div class="line">npm install ajv-keywords</div></div><!-- fragment --><h2>Usage</h2>
<p>To add all available keywords:</p>
<div class="fragment"><div class="line">var Ajv = require(&#39;ajv&#39;);</div><div class="line">var ajv = new Ajv;</div><div class="line">require(&#39;ajv-keywords&#39;)(ajv);</div><div class="line"></div><div class="line">ajv.validate({ instanceof: &#39;RegExp&#39; }, /.*/); // true</div><div class="line">ajv.validate({ instanceof: &#39;RegExp&#39; }, &#39;.*&#39;); // false</div></div><!-- fragment --><p>To add a single keyword:</p>
<div class="fragment"><div class="line">require(&#39;ajv-keywords&#39;)(ajv, &#39;instanceof&#39;);</div></div><!-- fragment --><p>To add multiple keywords:</p>
<div class="fragment"><div class="line">require(&#39;ajv-keywords&#39;)(ajv, [&#39;typeof&#39;, &#39;instanceof&#39;]);</div></div><!-- fragment --><p>To add a single keyword in browser (to avoid adding unused code):</p>
<div class="fragment"><div class="line">require(&#39;ajv-keywords/keywords/instanceof&#39;)(ajv);</div></div><!-- fragment --><h2>Keywords</h2>
<h3><code>typeof</code></h3>
<p>Based on JavaScript <code>typeof</code> operation.</p>
<p>The value of the keyword should be a string (<code>"undefined"</code>, <code>"string"</code>, <code>"number"</code>, <code>"object"</code>, <code>"function"</code>, <code>"boolean"</code> or <code>"symbol"</code>) or array of strings.</p>
<p>To pass validation the result of <code>typeof</code> operation on the value should be equal to the string (or one of the strings in the array).</p>
<div class="fragment"><div class="line">ajv.validate({ typeof: &#39;undefined&#39; }, undefined); // true</div><div class="line">ajv.validate({ typeof: &#39;undefined&#39; }, null); // false</div><div class="line">ajv.validate({ typeof: [&#39;undefined&#39;, &#39;object&#39;] }, null); // true</div></div><!-- fragment --><h3><code>instanceof</code></h3>
<p>Based on JavaScript <code>instanceof</code> operation.</p>
<p>The value of the keyword should be a string (<code>"Object"</code>, <code>"Array"</code>, <code>"Function"</code>, <code>"Number"</code>, <code>"String"</code>, <code>"Date"</code>, <code>"RegExp"</code> or <code>"Buffer"</code>) or array of strings.</p>
<p>To pass validation the result of <code>data instanceof ...</code> operation on the value should be true:</p>
<div class="fragment"><div class="line">ajv.validate({ instanceof: &#39;Array&#39; }, []); // true</div><div class="line">ajv.validate({ instanceof: &#39;Array&#39; }, {}); // false</div><div class="line">ajv.validate({ instanceof: [&#39;Array&#39;, &#39;Function&#39;] }, funciton(){}); // true</div></div><!-- fragment --><p>You can add your own constructor function to be recognised by this keyword:</p>
<div class="fragment"><div class="line">function MyClass() {}</div><div class="line">var instanceofDefinition = require(&#39;ajv-keywords&#39;).get(&#39;instanceof&#39;).definition;</div><div class="line">// or require(&#39;ajv-keywords/keywords/instanceof&#39;).definition;</div><div class="line">instanceofDefinition.CONSTRUCTORS.MyClass = MyClass;</div><div class="line"></div><div class="line">ajv.validate({ instanceof: &#39;MyClass&#39; }, new MyClass); // true</div></div><!-- fragment --><h3><code>range</code> and <code>exclusiveRange</code></h3>
<p>Syntax sugar for the combination of minimum and maximum keywords, also fails schema compilation if there are no numbers in the range.</p>
<p>The value of this keyword must be the array consisting of two numbers, the second must be greater or equal than the first one.</p>
<p>If the validated value is not a number the validation passes, otherwise to pass validation the value should be greater (or equal) than the first number and smaller (or equal) than the second number in the array. If <code>exclusiveRange</code> keyword is present in the same schema and its value is true, the validated value must not be equal to the range boundaries.</p>
<div class="fragment"><div class="line">var schema = { range: [1, 3] };</div><div class="line">ajv.validate(schema, 1); // true</div><div class="line">ajv.validate(schema, 2); // true</div><div class="line">ajv.validate(schema, 3); // true</div><div class="line">ajv.validate(schema, 0.99); // false</div><div class="line">ajv.validate(schema, 3.01); // false</div><div class="line"></div><div class="line">var schema = { range: [1, 3], exclusiveRange: true };</div><div class="line">ajv.validate(schema, 1.01); // true</div><div class="line">ajv.validate(schema, 2); // true</div><div class="line">ajv.validate(schema, 2.99); // true</div><div class="line">ajv.validate(schema, 1); // false</div><div class="line">ajv.validate(schema, 3); // false</div></div><!-- fragment --><h3><code>propertyNames</code></h3>
<p>This keyword allows to define the schema for the property names of the object. The value of this keyword should be a valid JSON schema (v5 schemas are supported with Ajv option <code>{v5: true}</code>).</p>
<div class="fragment"><div class="line">var schema = {</div><div class="line">  type: &#39;object&#39;</div><div class="line">  propertyNames: {</div><div class="line">    anyOf: [</div><div class="line">      { format: ipv4 },</div><div class="line">      { format: hostname }</div><div class="line">    ]</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line">var validData = {</div><div class="line">  &#39;192.128.0.1&#39;: {},</div><div class="line">  &#39;test.example.com&#39;: {}</div><div class="line">};</div><div class="line"></div><div class="line">var invalidData = {</div><div class="line">  &#39;1.2.3&#39;: {}</div><div class="line">};</div><div class="line"></div><div class="line">ajv.validate(schema, validData); // true</div><div class="line">ajv.validate(schema, invalidData); // false</div></div><!-- fragment --><p><b>Please note</b>: This keyword will be added to the next version of the JSON-Schema standard (draft-6), after it is published the keyword will be included in Ajv as standard validation keyword.</p>
<h3><code>if</code>/<code>then</code>/<code>else</code></h3>
<p>These keywords allow to implement conditional validation. Their values should be valid JSON-schemas. At the moment it requires using Ajv with v5 option.</p>
<p>If the data is valid according to the sub-schema in <code>if</code> keyword, then the result is equal to the result of data validation against the sub-schema in <code>then</code> keyword, otherwise - in <code>else</code> keyword (if <code>else</code> is absent, the validation succeeds).</p>
<div class="fragment"><div class="line">require(&#39;ajv-keywords&#39;)(ajv, &#39;if&#39;);</div><div class="line"></div><div class="line">var schema = {</div><div class="line">  type: &#39;array&#39;,</div><div class="line">  items: {</div><div class="line">    type: &#39;integer&#39;,</div><div class="line">    minimum: 1,</div><div class="line">    if: { maximum: 10 },</div><div class="line">    then: { multipleOf: 2 },</div><div class="line">    else: { multipleOf: 5 }</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line">var validItems = [ 2, 4, 6, 8, 10, 15, 20, 25 ]; // etc.</div><div class="line"></div><div class="line">var invalidItems = [ 1, 3, 5, 11, 12 ]; // etc.</div><div class="line"></div><div class="line">ajv.validate(schema, validItems); // true</div><div class="line">ajv.validate(schema, invalidItems); // false</div></div><!-- fragment --><p>This keyword is <a href="https://github.com/json-schema-org/json-schema-spec/issues/180">proposed</a> for the future version of JSON-Schema standard.</p>
<h3><code>prohibited</code></h3>
<p>This keyword allows to prohibit that any of the properties in the list is present in the object.</p>
<p>This keyword applies only to objects. If the data is not an object, the validation succeeds.</p>
<p>The value of this keyword should be an array of strings, each string being a property name. For data object to be valid none of the properties in this array should be present in the object.</p>
<div class="fragment"><div class="line">var schema = { prohibited: [&#39;foo&#39;, &#39;bar&#39;]};</div><div class="line"></div><div class="line">var validData = { baz: 1 };</div><div class="line">var alsoValidData = {};</div><div class="line"></div><div class="line">var invalidDataList = [</div><div class="line">  { foo: 1 },</div><div class="line">  { bar: 2 },</div><div class="line">  { foo: 1, bar: 2}</div><div class="line">];</div></div><!-- fragment --><h3><code>deepRequired</code></h3>
<p>This keyword allows to check that some deep properties (identified by JSON pointers) are available. The value should be an array of JSON pointers to the data, starting from the current position in data.</p>
<div class="fragment"><div class="line">var schema = {</div><div class="line">  type: &#39;object&#39;,</div><div class="line">  deepRequired: [&quot;/users/1/role&quot;]</div><div class="line">};</div><div class="line"></div><div class="line">var validData = {</div><div class="line">  users: [</div><div class="line">    {},</div><div class="line">    {</div><div class="line">      id: 123,</div><div class="line">      role: &#39;admin&#39;</div><div class="line">    }</div><div class="line">  ]</div><div class="line">};</div><div class="line"></div><div class="line">var invalidData = {</div><div class="line">  users: [</div><div class="line">    {},</div><div class="line">    {</div><div class="line">      id: 123</div><div class="line">    }</div><div class="line">  ]</div><div class="line">};</div></div><!-- fragment --><p>See <a href="https://github.com/json-schema-org/json-schema-spec/issues/203#issue-197211916">json-schema-org/json-schema-spec#203</a> for an example of the equivalent schema without <code>deepRequired</code> keyword.</p>
<h2><code>deepProperties</code></h2>
<p>This keyword allows to validate deep properties (identified by JSON pointers). The value should be an object, where keys are JSON pointers to the data, starting from the current position in data, and the values are corresponding schemas.</p>
<div class="fragment"><div class="line">var schema = {</div><div class="line">  type: &#39;object&#39;,</div><div class="line">  deepProperties: {</div><div class="line">    &quot;/users/1/role&quot;: { &quot;enum&quot;: [&quot;admin&quot;] }</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line">var validData = {</div><div class="line">  users: [</div><div class="line">    {},</div><div class="line">    {</div><div class="line">      id: 123,</div><div class="line">      role: &#39;admin&#39;</div><div class="line">    }</div><div class="line">  ]</div><div class="line">};</div><div class="line"></div><div class="line">var alsoValidData = {</div><div class="line">  users: {</div><div class="line">    &quot;1&quot;: {</div><div class="line">      id: 123,</div><div class="line">      role: &#39;admin&#39;</div><div class="line">    }</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line">var invalidData = {</div><div class="line">  users: [</div><div class="line">    {},</div><div class="line">    {</div><div class="line">      id: 123,</div><div class="line">      role: &#39;user&#39;</div><div class="line">    }</div><div class="line">  ]</div><div class="line">};</div><div class="line"></div><div class="line">var alsoInvalidData = {</div><div class="line">  users: {</div><div class="line">    &quot;1&quot;: {</div><div class="line">      id: 123,</div><div class="line">      role: &#39;user&#39;</div><div class="line">    }</div><div class="line">  }</div><div class="line">};</div></div><!-- fragment --><h3><code>regexp</code></h3>
<p>This keyword allows to use regular expressions with flags in schemas (the standard <code>pattern</code> keyword does not support flags). The value of this keyword can be either a string (the result of <code>regexp.toString()</code>) or an object with the properties <code>pattern</code> and <code>flags</code> (the same strings that should be passed to RegExp constructor).</p>
<div class="fragment"><div class="line">var schema = {</div><div class="line">  type: &#39;object&#39;,</div><div class="line">  properties: {</div><div class="line">    foo: { regexp: &#39;/foo/i&#39; },</div><div class="line">    bar: { regexp: { pattern: &#39;bar&#39;, flags: &#39;i&#39; } }</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line">var validData = {</div><div class="line">  foo: &#39;Food&#39;,</div><div class="line">  bar: &#39;Barmen&#39;</div><div class="line">};</div><div class="line"></div><div class="line">var invalidData = {</div><div class="line">  foo: &#39;fog&#39;,</div><div class="line">  bar: &#39;bad&#39;</div><div class="line">};</div></div><!-- fragment --><h3><code>dynamicDefaults</code></h3>
<p>This keyword allows to assign dynamic defaults to properties, such as timestamps, unique IDs etc.</p>
<p>This keyword only works if <code>useDefaults</code> options is used and not inside <code>anyOf</code> keywrods etc., in the same way as <a href="https://github.com/epoberezkin/ajv#assigning-defaults">default keyword treated by Ajv</a>.</p>
<p>The keyword should be added on the object level. Its value should be an object with each property corresponding to a property name, in the same way as in standard <code>properties</code> keyword. The value of each property can be:</p>
<ul>
<li>an identifier of default function (a string)</li>
<li>an object with properties <code>func</code> (an identifier) and <code>args</code> (an object with parameters that will be passed to this function during schema compilation - see examples).</li>
</ul>
<p>The properties used in <code>dynamicDefaults</code> should not be added to <code>required</code> keyword (or validation will fail), because unlike <code>default</code> this keyword is processed after validation.</p>
<p>There are several predefined dynamic default functions:</p>
<ul>
<li><code>"timestamp"</code> - current timestamp in milliseconds</li>
<li><code>"datetime"</code> - current date and time as string (ISO, valid according to <code>date-time</code> format)</li>
<li><code>"date"</code> - current date as string (ISO, valid according to <code>date</code> format)</li>
<li><code>"time"</code> - current time as string (ISO, valid according to <code>time</code> format)</li>
<li><code>"random"</code> - pseudo-random number in [0, 1) interval</li>
<li><code>"randomint"</code> - pseudo-random integer number. If string is used as a property value, the function will randomly return 0 or 1. If object &lsquo;{func: 'randomint&rsquo;, max: N}<code>is used then the default will be an integer number in [0, N) interval. -</code>"seq"<code>- sequential integer number starting from 0. If string is used as a property value, the default sequence will be used. If object</code>{func: 'seq', name: 'foo'}<code>is used then the sequence with name</code>"foo"` will be used. Sequences are global, even if different ajv instances are used.</li>
</ul>
<div class="fragment"><div class="line">var schema = {</div><div class="line">  type: &#39;object&#39;,</div><div class="line">  dynamicDefaults: {</div><div class="line">    ts: &#39;datetime&#39;,</div><div class="line">    r: { func: &#39;randomint&#39;, max: 100 },</div><div class="line">    id: { func: &#39;seq&#39;, name: &#39;id&#39; }</div><div class="line">  },</div><div class="line">  properties: {</div><div class="line">    ts: {</div><div class="line">      type: &#39;string&#39;,</div><div class="line">      format: &#39;datetime&#39;</div><div class="line">    },</div><div class="line">    r: {</div><div class="line">      type: &#39;integer&#39;,</div><div class="line">      minimum: 0,</div><div class="line">      maximum: 100,</div><div class="line">      exclusiveMaximum: true</div><div class="line">    },</div><div class="line">    id: {</div><div class="line">      type: &#39;integer&#39;,</div><div class="line">      minimum: 0</div><div class="line">    }</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line">var data = {};</div><div class="line">ajv.validate(data); // true</div><div class="line">data; // { ts: &#39;2016-12-01T22:07:28.829Z&#39;, r: 25, id: 0 }</div><div class="line"></div><div class="line">var data1 = {};</div><div class="line">ajv.validate(data1); // true</div><div class="line">data1; // { ts: &#39;2016-12-01T22:07:29.832Z&#39;, r: 68, id: 1 }</div><div class="line"></div><div class="line">ajv.validate(data1); // true</div><div class="line">data1; // didn&#39;t change, as all properties were defined</div></div><!-- fragment --><p>You can add your own dynamic default function to be recognised by this keyword:</p>
<div class="fragment"><div class="line">var uuid = require(&#39;uuid&#39;);</div><div class="line"></div><div class="line">function uuidV4() { return uuid.v4(); }</div><div class="line"></div><div class="line">var definition = require(&#39;ajv-keywords&#39;).get(&#39;dynamicDefaults&#39;).definition;</div><div class="line">// or require(&#39;ajv-keywords/keywords/dynamicDefaults&#39;).definition;</div><div class="line">definition.DEFAULTS.uuid = uuidV4;</div><div class="line"></div><div class="line">var schema = {</div><div class="line">  dynamicDefaults: { id: &#39;uuid&#39; },</div><div class="line">  properties: { id: { type: &#39;string&#39;, format: &#39;uuid&#39; } }</div><div class="line">};</div><div class="line"></div><div class="line">var data = {};</div><div class="line">ajv.validate(schema, data); // true</div><div class="line">data; // { id: &#39;a1183fbe-697b-4030-9bcc-cfeb282a9150&#39; };</div><div class="line"></div><div class="line">var data1 = {};</div><div class="line">ajv.validate(schema, data1); // true</div><div class="line">data1; // { id: &#39;5b008de7-1669-467a-a5c6-70fa244d7209&#39; }</div></div><!-- fragment --><p>You also can define dynamic default that accepts parameters, e.g. version of uuid:</p>
<div class="fragment"><div class="line">var uuid = require(&#39;uuid&#39;);</div><div class="line"></div><div class="line">function getUuid(args) {</div><div class="line">  var version = &#39;v&#39; + (arvs &amp;&amp; args.v || 4);</div><div class="line">  return function() {</div><div class="line">    return uuid[version]();</div><div class="line">  };</div><div class="line">}</div><div class="line"></div><div class="line">var definition = require(&#39;ajv-keywords&#39;).get(&#39;dynamicDefaults&#39;).definition;</div><div class="line">definition.DEFAULTS.uuid = getUuid;</div><div class="line"></div><div class="line">var schema = {</div><div class="line">  dynamicDefaults: {</div><div class="line">    id1: &#39;uuid&#39;, // v4</div><div class="line">    id2: { func: &#39;uuid&#39;, v: 4 }, // v4</div><div class="line">    id3: { func: &#39;uuid&#39;, v: 1 } // v1</div><div class="line">  }</div><div class="line">};</div></div><!-- fragment --><h2>License</h2>
<p><a href="https://github.com/JSONScript/ajv-keywords/blob/master/LICENSE">MIT</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者 &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
