<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>demo: compression</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">demo
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Vfunc Spring Boot项目概要</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">compression </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://npmjs.org/package/compression"></a> <a href="https://npmjs.org/package/compression"></a> <a href="https://travis-ci.org/expressjs/compression"></a> <a href="https://coveralls.io/r/expressjs/compression?branch=master"></a> <a href="https://www.gratipay.com/dougwilson/"></a></p>
<p>Node.js compression middleware.</p>
<p>The following compression codings are supported:</p>
<ul>
<li>deflate</li>
<li>gzip</li>
</ul>
<h2>Install</h2>
<div class="fragment"><div class="line">$ npm install compression</div></div><!-- fragment --><h2>API</h2>
<div class="fragment"><div class="line">var compression = require(&#39;compression&#39;)</div></div><!-- fragment --><h3>compression([options])</h3>
<p>Returns the compression middleware using the given <code>options</code>. The middleware will attempt to compress response bodies for all request that traverse through the middleware, based on the given <code>options</code>.</p>
<p>This middleware will never compress responses that include a <code>Cache-Control</code> header with the <a href="https://tools.ietf.org/html/rfc7234#section-5.2.2.4"><code>no-transform</code> directive</a>, as compressing will transform the body.</p>
<h4>Options</h4>
<p><code>compression()</code> accepts these properties in the options object. In addition to those listed below, <a href="http://nodejs.org/api/zlib.html">zlib</a> options may be passed in to the options object.</p>
<h5>chunkSize</h5>
<p>The default value is <code>zlib.Z_DEFAULT_CHUNK</code>, or <code>16384</code>.</p>
<p>See <a href="http://nodejs.org/api/zlib.html#zlib_memory_usage_tuning">Node.js documentation</a> regarding the usage.</p>
<h5>filter</h5>
<p>A function to decide if the response should be considered for compression. This function is called as <code>filter(req, res)</code> and is expected to return <code>true</code> to consider the response for compression, or <code>false</code> to not compress the response.</p>
<p>The default filter function uses the <a href="https://www.npmjs.com/package/compressible">compressible</a> module to determine if &lsquo;res.getHeader('Content-Type&rsquo;)` is compressible.</p>
<h5>level</h5>
<p>The level of zlib compression to apply to responses. A higher level will result in better compression, but will take longer to complete. A lower level will result in less compression, but will be much faster.</p>
<p>This is an integer in the range of <code>0</code> (no compression) to <code>9</code> (maximum compression). The special value <code>-1</code> can be used to mean the "default
compression level", which is a default compromise between speed and compression (currently equivalent to level 6).</p>
<ul>
<li><code>-1</code> Default compression level (also <code>zlib.Z_DEFAULT_COMPRESSION</code>).</li>
<li><code>0</code> No compression (also <code>zlib.Z_NO_COMPRESSION</code>).</li>
<li><code>1</code> Fastest compression (also <code>zlib.Z_BEST_SPEED</code>).</li>
<li><code>2</code></li>
<li><code>3</code></li>
<li><code>4</code></li>
<li><code>5</code></li>
<li><code>6</code> (currently what <code>zlib.Z_DEFAULT_COMPRESSION</code> points to).</li>
<li><code>7</code></li>
<li><code>8</code></li>
<li><code>9</code> Best compression (also <code>zlib.Z_BEST_COMPRESSION</code>).</li>
</ul>
<p>The default value is <code>zlib.Z_DEFAULT_COMPRESSION</code>, or <code>-1</code>.</p>
<p><b>Note</b> in the list above, <code>zlib</code> is from &lsquo;zlib = require('zlib&rsquo;)`.</p>
<h5>memLevel</h5>
<p>This specifies how much memory should be allocated for the internal compression state and is an integer in the range of <code>1</code> (minimum level) and <code>9</code> (maximum level).</p>
<p>The default value is <code>zlib.Z_DEFAULT_MEMLEVEL</code>, or <code>8</code>.</p>
<p>See <a href="http://nodejs.org/api/zlib.html#zlib_memory_usage_tuning">Node.js documentation</a> regarding the usage.</p>
<h5>strategy</h5>
<p>This is used to tune the compression algorithm. This value only affects the compression ratio, not the correctness of the compressed output, even if it is not set appropriately.</p>
<ul>
<li><code>zlib.Z_DEFAULT_STRATEGY</code> Use for normal data.</li>
<li><code>zlib.Z_FILTERED</code> Use for data produced by a filter (or predictor). Filtered data consists mostly of small values with a somewhat random distribution. In this case, the compression algorithm is tuned to compress them better. The effect is to force more Huffman coding and less string matching; it is somewhat intermediate between <code>zlib.Z_DEFAULT_STRATEGY</code> and <code>zlib.Z_HUFFMAN_ONLY</code>.</li>
<li><code>zlib.Z_FIXED</code> Use to prevent the use of dynamic Huffman codes, allowing for a simpler decoder for special applications.</li>
<li><code>zlib.Z_HUFFMAN_ONLY</code> Use to force Huffman encoding only (no string match).</li>
<li><code>zlib.Z_RLE</code> Use to limit match distances to one (run-length encoding). This is designed to be almost as fast as <code>zlib.Z_HUFFMAN_ONLY</code>, but give better compression for PNG image data.</li>
</ul>
<p><b>Note</b> in the list above, <code>zlib</code> is from &lsquo;zlib = require('zlib&rsquo;)`.</p>
<h5>threshold</h5>
<p>The byte threshold for the response body size before compression is considered for the response, defaults to <code>1kb</code>. This is a number of bytes, any string accepted by the <a href="https://www.npmjs.com/package/bytes">bytes</a> module, or <code>false</code>.</p>
<p><b>Note</b> this is only an advisory setting; if the response size cannot be determined at the time the response headers are written, then it is assumed the response is <em>over</em> the threshold. To guarantee the response size can be determined, be sure set a <code>Content-Length</code> response header.</p>
<h5>windowBits</h5>
<p>The default value is <code>zlib.Z_DEFAULT_WINDOWBITS</code>, or <code>15</code>.</p>
<p>See <a href="http://nodejs.org/api/zlib.html#zlib_memory_usage_tuning">Node.js documentation</a> regarding the usage.</p>
<h4>.filter</h4>
<p>The default <code>filter</code> function. This is used to construct a custom filter function that is an extension of the default function.</p>
<div class="fragment"><div class="line">app.use(compression({filter: shouldCompress}))</div><div class="line"></div><div class="line">function shouldCompress(req, res) {</div><div class="line">  if (req.headers[&#39;x-no-compression&#39;]) {</div><div class="line">    // don&#39;t compress responses with this request header</div><div class="line">    return false</div><div class="line">  }</div><div class="line"></div><div class="line">  // fallback to standard filter function</div><div class="line">  return compression.filter(req, res)</div><div class="line">}</div></div><!-- fragment --><h3>res.flush</h3>
<p>This module adds a <code>res.flush()</code> method to force the partially-compressed response to be flushed to the client.</p>
<h2>Examples</h2>
<h3>express/connect</h3>
<p>When using this module with express or connect, simply <code>app.use</code> the module as high as you like. Requests that pass through the middleware will be compressed.</p>
<div class="fragment"><div class="line">var compression = require(&#39;compression&#39;)</div><div class="line">var express = require(&#39;express&#39;)</div><div class="line"></div><div class="line">var app = express()</div><div class="line"></div><div class="line">// compress all requests</div><div class="line">app.use(compression())</div><div class="line"></div><div class="line">// add all routes</div></div><!-- fragment --><h3>Server-Sent Events</h3>
<p>Because of the nature of compression this module does not work out of the box with server-sent events. To compress content, a window of the output needs to be buffered up in order to get good compression. Typically when using server-sent events, there are certain block of data that need to reach the client.</p>
<p>You can achieve this by calling <code>res.flush()</code> when you need the data written to actually make it to the client.</p>
<div class="fragment"><div class="line">var compression = require(&#39;compression&#39;)</div><div class="line">var express     = require(&#39;express&#39;)</div><div class="line"></div><div class="line">var app = express()</div><div class="line"></div><div class="line">// compress responses</div><div class="line">app.use(compression())</div><div class="line"></div><div class="line">// server-sent event stream</div><div class="line">app.get(&#39;/events&#39;, function (req, res) {</div><div class="line">  res.setHeader(&#39;Content-Type&#39;, &#39;text/event-stream&#39;)</div><div class="line">  res.setHeader(&#39;Cache-Control&#39;, &#39;no-cache&#39;)</div><div class="line"></div><div class="line">  // send a ping approx every 2 seconds</div><div class="line">  var timer = setInterval(function () {</div><div class="line">    res.write(&#39;data: ping\n\n&#39;)</div><div class="line"></div><div class="line">    // !!! this is the important part</div><div class="line">    res.flush()</div><div class="line">  }, 2000)</div><div class="line"></div><div class="line">  res.on(&#39;close&#39;, function () {</div><div class="line">    clearInterval(timer)</div><div class="line">  })</div><div class="line">})</div></div><!-- fragment --><h2>License</h2>
<p>[MIT](LICENSE) </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者 &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
